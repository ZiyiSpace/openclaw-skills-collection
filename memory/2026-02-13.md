# 2026-02-13

## 记忆刷新 - Pre-compaction

### OpenClaw Agent 迁移决策

**目标**：在另一台 Windows 电脑上复刻当前的 Agent 行为模式

**迁移方案**：
- **范围**：只迁移 `~/.openclaw/workspace/`（行为模式），不迁移配置/凭证
- **方式**：直接复制（不压缩），遵循 SOUL.md 的直径原则
- **传输介质**：U 盘
- **不需要**：持续同步（Git 方案 rejected）

**Workspace 核心组件**（652K）：
```
~/.openclaw/workspace/
├── SOUL.md                 # 协作偏好、行为边界
├── AGENTS.md              # Agent 工作指南
├── TOOLS.md               # 工具本地配置
├── HEARTBEAT.md           # 心跳检查清单（含技能索引更新任务）
├── IDENTITY.md            # 身份定义
├── skills-index.md        # 3002+ 技能索引（45KB）
├── memory/
│   └── skills-state.json  # 技能索引更新状态
└── skills/                # 自定义技能
    ├── openrouter-xiaohongshu/
    └── openclaw-update-checker/
```

**Windows 端操作流程**：
1. 从 U 盘读取 `workspace-soul.tgz`（或直接复制文件夹）
2. 解压到 `C:\Users\<用户>\.openclaw\workspace\`
3. 运行 `openclaw onboard` 配置 API 密钥（两台机器的 API key 不同，必须重新配置）
4. `openclaw gateway restart` 启动
5. 验证：测试 SOUL.md 是否生效、技能检索是否正常

**关键约束**：
- 两台机器的 API 密钥不同，不能迁移 `~/.openclaw/credentials/`
- 必须在 Windows 上重新配置 OpenClaw（API 密钥、通道配对等）
- 只复制行为模式，不涉及敏感信息

---

### U 盘传输问题

**检测到**：
- 设备：`thinkplus` U 盘（125.8 GB，FAT32 格式）
- 挂载路径：`/Volumes/thinkplus/`
- 空间：117GB 可用

**问题**：
- `df` 命令能正常读取磁盘信息
- 访问 `/Volumes/thinkplus/` 目录时卡住，无法复制文件

**可能原因**：
1. U 盘文件系统损坏
2. 写保护或连接不稳定
3. macOS 兼容性问题

**待解决**：
- 用户需要重新插拔 U 盘或更换设备
- 或改用其他传输方式（网盘、局域网共享）

---

### 技能检索机制

**来源**：GitHub 仓库 `VoltAgent/awesome-openclaw-skills`

**更新机制**（通过 HEARTBEAT.md）：
1. 每次心跳检查 GitHub API 最新 commit SHA
2. 对比 `memory/skills-state.json` 记录的 SHA
3. 如果不同：重新解析 README.md，更新 `skills-index.md`
4. 更新 `skills-state.json` 记录新 SHA

**使用方式**：
- 当用户提到需求（如"图片制作"）时，主动查找 `skills-index.md`
- 推荐可用的 tools/skills

---

### 技能索引更新检查

**当前状态**：
- `skills-index.md` 存在（45KB，3002+ skills）
- `memory/skills-state.json` 存在
- HEARTBEAT.md 配置了定期更新任务

**下次心跳**：检查是否有新技能更新

---

### SOUL.md 直径原则提醒

用户提醒：迁移时应遵循 SOUL.md 中的**直径原则**（最短可行路径）
- 能直接复制就不要压缩
- 能用简单方案就不要引入额外步骤
- 避免"为了全面而啰嗦"

---

## 技术细节

**OpenClaw 安装文档路径**：
- `/opt/homebrew/lib/node_modules/openclaw/docs/install/`
- 官方迁移指南：`migrating.md`

**迁移方式对比**：
- 方案 A：完整迁移（state + workspace）- 保留所有配置/会话，包含敏感信息
- 方案 B：最小化迁移（仅 workspace）- ✅ 已选择
- 方案 C：Git 同步 - 长期维护方案（用户 rejected）

---

## 待办

- [ ] 解决 U 盘访问问题，完成 workspace 复制
- [ ] Windows 端验证迁移结果
- [ ] 测试技能检索、SOUL.md 生效情况
