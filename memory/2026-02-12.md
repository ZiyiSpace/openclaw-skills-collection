# 2026-02-12 Memory

## 今日重要事件

### 1. SOUL.md 协作偏好更新
用户更新了完整的协作偏好文档，定义了我们的协作模式：

**核心原则**：
- 目标：帮助用户想清楚问题，而非替用户做决定
- 协作基线：理性、谨慎、授权优先
- 默认模式：被动响应为主，但在用户思考不完整时主动补全盲区
- 全面性优先：用户未说"想清楚"前，默认假设思考不完整
- 联网搜索：默认行为，时效性/变化/模糊问题必须先搜
- 直径原则：想全但做简，最短可行路径优先
- 特质优先级：先对，再全，再快

**权限边界**：
- 未经明确指示，不得修改/删除/创建文件
- 未经许可，不主动扫描文件系统
- 是建议者，不是决策者

**元原则**：安全 > 可控性 > 效率

---

### 2. OpenRouter 小红书日更项目（已完成）

**项目目标**：
以 OpenRouter Apps 页面（https://openrouter.ai/apps?url=https%3A%2F%2Fopenclaw.ai%2F）为数据源，每天截图并生成结构化文案，发布到小红书。

**已完成的实现**：

1. **Skill 创建完成**
   - 位置：`/Users/wangziyi/.openclaw/workspace/skills/openrouter-xiaohongshu/`
   - 文件结构：
     - SKILL.md - 技能说明
     - README.md - 使用文档
     - scripts/generate_post_final.py - 主脚本（生成中英文文案）
     - scripts/fetch_data.py - 数据提取脚本
     - templates/ - 文案模板
     - references/ - 页面结构参考
     - test.sh - 测试脚本
     - cron-config.json - Cron 配置

2. **数据抓取流程验证通过**
   - ✅ Browser 访问 OpenRouter Apps 页面
   - ✅ 点击最后一个柱状条（ref=e86）显示日用量数据
   - ✅ 提取日用量排行榜数据

3. **文案生成完成**
   - ✅ 中文文案（小红书格式）
   - ✅ 英文文案（Twitter 格式）
   - ✅ 按用量排序，取前 6 名

4. **输出架构设计完成**
   ```
   openrouter-xiaohongshu/
   └── 2026-02-12/
       ├── post-cn.md        # 中文文案（小红书）
       ├── post-en.md        # 英文文案（Twitter）
       ├── screenshot.jpg    # 榜单截图
       └── data.json         # 原始数据
   ```

5. **Cron 定时设置**
   - ✅ 已注册到 OpenClaw cron
   - ✅ 调度时间：每天上午 10:00（Asia/Shanghai）
   - ✅ 下次运行：2026-02-13 10:00
   - Job ID: 4fcb2b45-59ab-49f6-a528-2309b03e3995

---

## 关键技术细节

### 数据来源
- **月用量排行榜**：https://openrouter.ai/apps?url=https%3A%2F%2Fopenclaw.ai%2F
  - 显示：前 20 个模型的月总消耗量（几百亿 tokens）
  - 页面 DOM 包含："1." "2." 等排名 + 模型名 + 用量（如 "340Btokens"）

- **日用量详情**：点击最后一个柱状条（ref=e86）后显示
  - 显示：单日模型排行榜 + 消耗量（如 "551K"）
  - 数据格式：模型名 + K/M 单位
  - 总消耗：1.28M（示例）

### 文案格式

**中文版（小红书）**：
```
📊 2026年02月12日 OpenClaw 日用量榜单

📋 模型 | 日消耗量 | 评价
------------------------------
👑 GPT-4o-mini | 551K | 日常主力
💎 Claude 3.5 Sonnet | 277K | 稳定输出
🌟 Sonar Pro | 220K | 表现亮眼
🍌 Nano Banana Pro | 62K | 新兴选择
🔍 DeepSeek V3 | 45K | 性价比高
📡 Sonar | 33K | 小众黑马

💡 总消耗：1.28M（比昨天略有增长）

👉 评论区：你现在用哪个当主力？
下期做「红黑榜+迁移理由」
```

**英文版（Twitter）**：
```
OpenClaw daily usage (Feb 12):
• GPT-4o-mini — 551K (dominant)
• Claude 3.5 Sonnet — 277K
• Sonar Pro — 220K
• Nano Banana Pro (Gemini 3 Pro Image Preview) — 62K
• DeepSeek V3 — 45K
• Sonar — 33K
• Sonar Deep Research — 15K
• Sonar Pro Search — 5.28K
Total: 1.28M (slightly up vs yesterday).
What's your daily driver + 1 use case?
#OpenClaw #LLM #AIAgents
```

### 手动执行流程

如果需要手动执行，步骤如下：

1. 启动 browser：
   ```
   browser: start(profile="openclaw")
   ```

2. 导航到页面：
   ```
   browser: navigate(targetUrl="https://openrouter.ai/apps?url=https%3A%2F%2Fopenclaw.ai%2F", profile="openclaw")
   ```

3. 点击最后一个柱状条（显示日用量）：
   ```
   browser: act(targetId="...", request={"kind": "click", "ref": "e86"})
   ```

4. 获取页面快照并保存：
   ```
   browser: snapshot(targetId="...", refs="role") > /tmp/daily_usage_snapshot.txt
   ```

5. 运行生成脚本：
   ```
   exec: python3 /Users/wangziyi/.openclaw/workspace/skills/openrouter-xiaohongshu/scripts/generate_post_final.py /tmp/daily_usage_snapshot.txt ~/Desktop/openrouter-xiaohongshu
   ```

### 自动执行（Cron）

Cron 每天上午 10:00 触发，发送 systemEvent 到主会话。

---

## 用户偏好记录

- 名称：未定义（IDENTITY.md 待更新）
- 时区：Asia/Shanghai
- 联系方式：webchat（当前会话）

---

### 3. OpenClaw 每日更新检查（已完成）

**项目目标**：
每天自动检查 GitHub releases，发现新版本时生成结构化更新文件，保存到桌面。

**已完成的实现**：

1. **Skill 创建完成**
   - 位置：`/Users/wangziyi/.openclaw/workspace/skills/openclaw-update-checker/`
   - 文件结构：
     - SKILL.md - 技能说明
     - scripts/check.sh - 检查脚本

2. **Cron 定时设置**
   - ✅ 已注册到 OpenClaw cron
   - ✅ 调度时间：每天早上 9:00（Asia/Shanghai）
   - ✅ 下次运行：2026-02-13 09:00
   - Job ID: 470b3ed1-1cde-4325-bab7-1895fa84e8b6

3. **输出目录**
   - 路径：`/Users/wangziyi/Desktop/openclaw-update/`
   - 文件格式：
     - `{版本号}.md` - 版本更新文件（如 2026.2.9.md）
     - `last-checked-version.json` - 记录上次检查的版本

4. **文件内容结构**
   ```markdown
   # OpenClaw 更新：{版本号}

   ## 版本号
   {版本号}

   ## 详细内容
   {完整的 changelog（Added + Fixes）}

   ## 对大众用户的重点信息
   {提炼的有效信息：新功能、重要修复、体验改进}

   ---
   生成时间：{时间戳}
   ```

5. **测试验证**
   - ✅ 成功生成 2026.2.9.md（7.8KB）
   - ✅ 内容结构符合要求
   - ✅ 版本记录更新成功

---

## 待办事项

- [ ] 更新 IDENTITY.md（姓名、人格）
- [ ] 更新 USER.md（用户信息）
- [ ] 测试 OpenRouter 自动执行（明天 10:00 第一次自动运行）
- [ ] 测试 OpenClaw 更新检查自动执行（明天 9:00 第一次自动运行）
- [ ] 观察数据准确性，调整数据提取逻辑（如有必要）

---

### 4. Skills 索引系统（已完成）

**项目目标**：
创建 OpenClaw Skills 全局索引，让所有会话都能主动推荐使用社区技能。

**已完成的实现**：

1. **技能索引创建**
   - 位置：`/Users/wangziyi/.openclaw/workspace/skills-index.md`
   - 数据来源：[VoltAgent/awesome-openclaw-skills](https://github.com/VoltAgent/awesome-openclaw-skills)
   - 解析方式：Python 脚本解析 README.md
   - 技能数量：3002 个
   - 分类数量：32 个
   - 文件大小：454KB（27166 行）

2. **技能分类统计**
   - AI & LLMs: 287（最大分类）
   - Web & Frontend Development: 202
   - DevOps & Cloud: 212
   - Search & Research: 253
   - Coding Agents & IDEs: 133
   - Communication: 132
   - Marketing & Sales: 143
   - Productivity & Tasks: 135
   - Browser & Automation: 139
   - 其他 21 个分类（50-129 个技能）

3. **状态存储文件**
   - 位置：`/Users/wangziyi/.openclaw/workspace/memory/skills-state.json`
   - 记录内容：
     - 当前 commit SHA
     - 最后更新时间
     - 技能总数
     - 各分类技能数

4. **心跳检查机制**
   - 更新了 `HEARTBEAT.md` 加入检查逻辑
   - 检查频率：每次心跳（由用户配置）
   - 更新方式：自动重新解析 + 更新索引 + 提醒用户

5. **隐私边界设计**
   - `skills-index.md`：全局可读（不涉及隐私，只是公开工具目录）
   - `skills-state.json`：全局可读（状态数据）
   - `MEMORY.md`：仅主会话加载（保护隐私）

6. **技能索引结构**
   ```markdown
   ## Category Name

   ### skill-slug
   **Description:** 技能描述
   **Install:** `npx clawhub@latest install skill-slug`
   ```

---

## 技术细节

### 脚本位置
- 解析脚本：`/tmp/parse_skills.py`
- 执行方式：`python3 /tmp/parse_skills.py`

### 输出文件
- 索引：`workspace/skills-index.md`
- 状态：`memory/skills-state.json`

### 心跳检查逻辑
1. 读取 `skills-state.json` 获取当前 commit SHA
2. 调用 GitHub API 检查最新 commit
3. 如果 SHA 不同：
   - 重新解析 README.md
   - 更新 `skills-index.md`
   - 更新 `skills-state.json`
   - 提醒用户："检测到技能索引有更新，已同步"

### 推荐机制（所有会话）
当用户提出需求时：
1. 分析用户意图（关键词、上下文）
2. 在 `skills-index.md` 中搜索相关技能
3. 如果找到匹配：
   - 主动提示："这个任务可以用某某 skill，描述是..."
   - 等待确认后，再安装/使用
